<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Check Matrix Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section {
            margin-bottom: 30px;
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 5px;
        }
        .section h2 {
            color: #333;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        .formula-box {
            background-color: #e8f4fd;
            padding: 15px;
            border-left: 4px solid #007bff;
            margin: 15px 0;
            border-radius: 4px;
        }
        .formula-box h4 {
            margin-top: 0;
            color: #0056b3;
        }
        .formula {
            background-color: #f8f9fa;
            padding: 8px 12px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            margin: 5px 0;
            border: 1px solid #dee2e6;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input[type="number"] {
            width: 200px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .results {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
        }
        .status-indicator {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
            vertical-align: middle;
        }
        .healthy { background-color: #28a745; }
        .warning { background-color: #ffc107; }
        .critical { background-color: #dc3545; }
        .metric-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            align-items: center;
        }
        .metric-name {
            width: 120px;
            font-weight: bold;
        }
        .correlation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }
        .result-value {
            font-weight: bold;
            color: #007bff;
        }
        .clear-btn {
            background-color: #6c757d;
        }
        .clear-btn:hover {
            background-color: #545b62;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: center;
        }
        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        .color-legend {
            display: flex;
            gap: 20px;
            margin: 10px 0;
            align-items: center;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Health Check Matrix Calculator</h1>
        
        <!-- Weekly Health Section -->
        <div class="section">
            <h2>Weekly Health Calculator</h2>
            
            <div class="formula-box">
                <h4>📋 Weekly Health Formulas</h4>
                
                <h5>Color Status Logic:</h5>
                <div class="formula">
                    IF Current = 0 → Critical (Red)<br>
                    IF Last = 0 AND Current > 0 → Healthy (Green)<br>
                    IF Ratio ≥ Green_Threshold (0.9) → Healthy (Green)<br>
                    IF Ratio ≥ Yellow_Threshold (0.5) → Warning (Yellow)<br>
                    ELSE → Critical (Red)
                </div>
                
                <h5>Ratio Calculation:</h5>
                <div class="formula">Ratio = Current Week ÷ Last Week</div>
                
                <h5>Percentage Change:</h5>
                <div class="formula">
                    IF Last = 0 AND Current = 0 → "0%"<br>
                    IF Last = 0 AND Current > 0 → "New"<br>
                    ELSE → ((Current - Last) ÷ Last) × 100
                </div>
                
                <h5>Health Score:</h5>
                <div class="formula">
                    Points: Green = 1, Yellow = 0.5, Red = 0<br>
                    Health Score = (Total Points ÷ 4 Metrics) × 100
                </div>

                <div class="color-legend">
                    <div class="legend-item">
                        <span class="status-indicator healthy"></span>
                        <span>Healthy (≥90%)</span>
                    </div>
                    <div class="legend-item">
                        <span class="status-indicator warning"></span>
                        <span>Warning (50-89%)</span>
                    </div>
                    <div class="legend-item">
                        <span class="status-indicator critical"></span>
                        <span>Critical (<50% or 0)</span>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Thresholds Configuration:</label>
                <div style="display: flex; gap: 20px;">
                    <div>
                        <label>Green Threshold:</label>
                        <input type="number" id="greenThreshold" value="0.9" step="0.01" min="0" max="1">
                    </div>
                    <div>
                        <label>Yellow Threshold:</label>
                        <input type="number" id="yellowThreshold" value="0.5" step="0.01" min="0" max="1">
                    </div>
                </div>
            </div>

            <div class="metric-row">
                <div class="metric-name">Appointments:</div>
                <input type="number" id="apptCurrent" placeholder="Current Week" min="0">
                <input type="number" id="apptLast" placeholder="Last Week" min="0">
            </div>
            
            <div class="metric-row">
                <div class="metric-name">Invoices:</div>
                <input type="number" id="invCurrent" placeholder="Current Week" min="0">
                <input type="number" id="invLast" placeholder="Last Week" min="0">
            </div>
            
            <div class="metric-row">
                <div class="metric-name">Claims:</div>
                <input type="number" id="claimsCurrent" placeholder="Current Week" min="0">
                <input type="number" id="claimsLast" placeholder="Last Week" min="0">
            </div>
            
            <div class="metric-row">
                <div class="metric-name">EOBs:</div>
                <input type="number" id="eobsCurrent" placeholder="Current Week" min="0">
                <input type="number" id="eobsLast" placeholder="Last Week" min="0">
            </div>

            <button onclick="calculateWeeklyHealth()">Calculate Health Metrics</button>
            <button onclick="clearWeeklyInputs()" class="clear-btn">Clear All</button>

            <div id="weeklyResults" class="results" style="display:none;">
                <h3>Results:</h3>
                <table id="resultsTable">
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th>Current Week</th>
                            <th>Last Week</th>
                            <th>Status</th>
                            <th>Ratio</th>
                            <th>Change %</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody">
                    </tbody>
                </table>
                <div style="margin-top: 15px;">
                    <strong>Overall Health Score: <span id="healthScore" class="result-value"></span>%</strong>
                </div>
            </div>
        </div>

        <!-- Correlation Panel Section -->
        <div class="section">
            <h2>Correlation Panel Field Formulas</h2>
            
            <div class="correlation-grid">
                
                <!-- Ratio Calculator -->
                <div>
                    <div class="formula-box">
                        <h4>🔢 Ratio Formula</h4>
                        <div class="formula">Ratio = Value1 ÷ Value2</div>
                        <p><strong>Purpose:</strong> Compare current performance to baseline</p>
                    </div>
                    
                    <h4>Ratio Calculator</h4>
                    <div class="form-group">
                        <label>Value 1 (Current):</label>
                        <input type="number" id="ratioValue1" placeholder="Enter value">
                    </div>
                    <div class="form-group">
                        <label>Value 2 (Previous):</label>
                        <input type="number" id="ratioValue2" placeholder="Enter value">
                    </div>
                    <button onclick="calculateRatio()">Calculate Ratio</button>
                    <div id="ratioResult" class="results" style="display:none; margin-top: 10px;">
                        <strong>Ratio: <span id="ratioValue" class="result-value"></span></strong>
                    </div>
                </div>

                <!-- Percentage Change Calculator -->
                <div>
                    <div class="formula-box">
                        <h4>📈 Percentage Change Formula</h4>
                        <div class="formula">
                            Change% = ((New - Old) ÷ Old) × 100<br>
                            Special Cases:<br>
                            • Old = 0, New = 0 → "0%"<br>
                            • Old = 0, New > 0 → "New"
                        </div>
                        <p><strong>Purpose:</strong> Show trend direction and magnitude</p>
                    </div>
                    
                    <h4>Percentage Change</h4>
                    <div class="form-group">
                        <label>New Value:</label>
                        <input type="number" id="changeNew" placeholder="Enter new value">
                    </div>
                    <div class="form-group">
                        <label>Old Value:</label>
                        <input type="number" id="changeOld" placeholder="Enter old value">
                    </div>
                    <button onclick="calculatePercentageChange()">Calculate Change</button>
                    <div id="changeResult" class="results" style="display:none; margin-top: 10px;">
                        <strong>Change: <span id="changeValue" class="result-value"></span>%</strong>
                    </div>
                </div>

                <!-- Status Determinator -->
                <div>
                    <div class="formula-box">
                        <h4>🚦 Status Determination Formula</h4>
                        <div class="formula">
                            IF Current = 0 → Critical<br>
                            IF Previous = 0 AND Current > 0 → Healthy<br>
                            IF Ratio ≥ Green_Threshold → Healthy<br>
                            IF Ratio ≥ Yellow_Threshold → Warning<br>
                            ELSE → Critical
                        </div>
                        <p><strong>Purpose:</strong> Visual health indicator with color coding</p>
                    </div>
                    
                    <h4>Status Determinator</h4>
                    <div class="form-group">
                        <label>Current Value:</label>
                        <input type="number" id="statusCurrent" placeholder="Enter current value">
                    </div>
                    <div class="form-group">
                        <label>Previous Value:</label>
                        <input type="number" id="statusPrevious" placeholder="Enter previous value">
                    </div>
                    <div class="form-group">
                        <label>Green Threshold:</label>
                        <input type="number" id="statusGreenThreshold" value="0.9" step="0.01" min="0" max="1">
                    </div>
                    <div class="form-group">
                        <label>Yellow Threshold:</label>
                        <input type="number" id="statusYellowThreshold" value="0.5" step="0.01" min="0" max="1">
                    </div>
                    <button onclick="calculateStatus()">Determine Status</button>
                    <div id="statusResult" class="results" style="display:none; margin-top: 10px;">
                        <div id="statusDisplay"></div>
                    </div>
                </div>

                <!-- Points Calculator -->
                <div>
                    <div class="formula-box">
                        <h4>⭐ Health Score Formula</h4>
                        <div class="formula">
                            Points Assignment:<br>
                            • Green (Healthy) = 1.0 point<br>
                            • Yellow (Warning) = 0.5 points<br>
                            • Red (Critical) = 0.0 points<br><br>
                            Health Score = (Total Points ÷ Total Metrics) × 100
                        </div>
                        <p><strong>Purpose:</strong> Overall company health rating (0-100%)</p>
                    </div>
                    
                    <h4>Points Calculator</h4>
                    <div class="form-group">
                        <label>Number of Green Statuses:</label>
                        <input type="number" id="greenCount" placeholder="Enter count" min="0">
                    </div>
                    <div class="form-group">
                        <label>Number of Yellow Statuses:</label>
                        <input type="number" id="yellowCount" placeholder="Enter count" min="0">
                    </div>
                    <div class="form-group">
                        <label>Number of Red Statuses:</label>
                        <input type="number" id="redCount" placeholder="Enter count" min="0">
                    </div>
                    <button onclick="calculatePoints()">Calculate Points</button>
                    <div id="pointsResult" class="results" style="display:none; margin-top: 10px;">
                        <strong>Total Points: <span id="pointsValue" class="result-value"></span></strong><br>
                        <strong>Health Score: <span id="pointsHealthScore" class="result-value"></span>%</strong>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // Weekly Health Calculator Functions
        function calculateWeeklyHealth() {
            const greenThreshold = parseFloat(document.getElementById('greenThreshold').value);
            const yellowThreshold = parseFloat(document.getElementById('yellowThreshold').value);
            
            const metrics = [
                {
                    name: 'Appointments',
                    current: parseFloat(document.getElementById('apptCurrent').value) || 0,
                    last: parseFloat(document.getElementById('apptLast').value) || 0
                },
                {
                    name: 'Invoices',
                    current: parseFloat(document.getElementById('invCurrent').value) || 0,
                    last: parseFloat(document.getElementById('invLast').value) || 0
                },
                {
                    name: 'Claims',
                    current: parseFloat(document.getElementById('claimsCurrent').value) || 0,
                    last: parseFloat(document.getElementById('claimsLast').value) || 0
                },
                {
                    name: 'EOBs',
                    current: parseFloat(document.getElementById('eobsCurrent').value) || 0,
                    last: parseFloat(document.getElementById('eobsLast').value) || 0
                }
            ];

            let totalPoints = 0;
            const resultsBody = document.getElementById('resultsBody');
            resultsBody.innerHTML = '';

            metrics.forEach(metric => {
                const status = determineStatus(metric.current, metric.last, greenThreshold, yellowThreshold);
                const ratio = metric.last !== 0 ? (metric.current / metric.last).toFixed(3) : 'N/A';
                const changePercent = calculateChange(metric.current, metric.last);
                const points = getPoints(status);
                
                totalPoints += points;

                const row = resultsBody.insertRow();
                row.innerHTML = `
                    <td><strong>${metric.name}</strong></td>
                    <td>${metric.current}</td>
                    <td>${metric.last}</td>
                    <td><span class="status-indicator ${status.toLowerCase()}"></span>${status}</td>
                    <td>${ratio}</td>
                    <td>${changePercent}</td>
                `;
            });

            const healthScore = ((totalPoints / 4) * 100).toFixed(1);
            document.getElementById('healthScore').textContent = healthScore;
            document.getElementById('weeklyResults').style.display = 'block';
        }

        function determineStatus(current, last, greenThreshold, yellowThreshold) {
            if (current === 0) return 'Critical';
            if (last === 0 && current > 0) return 'Healthy';
            
            const ratio = current / last;
            if (ratio >= greenThreshold) return 'Healthy';
            if (ratio >= yellowThreshold) return 'Warning';
            return 'Critical';
        }

        function calculateChange(current, last) {
            if (last === 0 && current === 0) return '0%';
            if (last === 0) return 'New';
            return (((current - last) / last) * 100).toFixed(1) + '%';
        }

        function getPoints(status) {
            switch(status) {
                case 'Healthy': return 1;
                case 'Warning': return 0.5;
                case 'Critical': return 0;
                default: return 0;
            }
        }

        function clearWeeklyInputs() {
            const inputs = ['apptCurrent', 'apptLast', 'invCurrent', 'invLast', 
                          'claimsCurrent', 'claimsLast', 'eobsCurrent', 'eobsLast'];
            inputs.forEach(id => document.getElementById(id).value = '');
            document.getElementById('weeklyResults').style.display = 'none';
        }

        // Correlation Panel Functions
        function calculateRatio() {
            const value1 = parseFloat(document.getElementById('ratioValue1').value);
            const value2 = parseFloat(document.getElementById('ratioValue2').value);
            
            if (isNaN(value1) || isNaN(value2)) {
                alert('Please enter valid numbers');
                return;
            }
            
            if (value2 === 0) {
                document.getElementById('ratioValue').textContent = 'Undefined (division by zero)';
            } else {
                const ratio = (value1 / value2).toFixed(3);
                document.getElementById('ratioValue').textContent = ratio;
            }
            
            document.getElementById('ratioResult').style.display = 'block';
        }

        function calculatePercentageChange() {
            const newValue = parseFloat(document.getElementById('changeNew').value);
            const oldValue = parseFloat(document.getElementById('changeOld').value);
            
            if (isNaN(newValue) || isNaN(oldValue)) {
                alert('Please enter valid numbers');
                return;
            }
            
            let changeText;
            if (oldValue === 0 && newValue === 0) {
                changeText = '0';
            } else if (oldValue === 0) {
                changeText = 'New (undefined)';
            } else {
                const change = ((newValue - oldValue) / oldValue) * 100;
                changeText = change.toFixed(1);
            }
            
            document.getElementById('changeValue').textContent = changeText;
            document.getElementById('changeResult').style.display = 'block';
        }

        function calculateStatus() {
            const current = parseFloat(document.getElementById('statusCurrent').value);
            const previous = parseFloat(document.getElementById('statusPrevious').value);
            const greenThreshold = parseFloat(document.getElementById('statusGreenThreshold').value);
            const yellowThreshold = parseFloat(document.getElementById('statusYellowThreshold').value);
            
            if (isNaN(current) || isNaN(previous)) {
                alert('Please enter valid numbers');
                return;
            }
            
            const status = determineStatus(current, previous, greenThreshold, yellowThreshold);
            const ratio = previous !== 0 ? (current / previous).toFixed(3) : 'N/A';
            
            document.getElementById('statusDisplay').innerHTML = `
                <div style="margin-bottom: 10px;">
                    <span class="status-indicator ${status.toLowerCase()}"></span>
                    <strong>Status: ${status}</strong>
                </div>
                <div><strong>Ratio: ${ratio}</strong></div>
            `;
            
            document.getElementById('statusResult').style.display = 'block';
        }

        function calculatePoints() {
            const greenCount = parseFloat(document.getElementById('greenCount').value) || 0;
            const yellowCount = parseFloat(document.getElementById('yellowCount').value) || 0;
            const redCount = parseFloat(document.getElementById('redCount').value) || 0;
            
            const totalPoints = (greenCount * 1) + (yellowCount * 0.5) + (redCount * 0);
            const totalMetrics = greenCount + yellowCount + redCount;
            const healthScore = totalMetrics > 0 ? ((totalPoints / totalMetrics) * 100).toFixed(1) : 0;
            
            document.getElementById('pointsValue').textContent = totalPoints.toFixed(1);
            document.getElementById('pointsHealthScore').textContent = healthScore;
            document.getElementById('pointsResult').style.display = 'block';
        }
    </script>
</body>
</html>
